create  database pizzahut;
create table orders (
order_id int not null ,
order_date date not null ,
order_time time not null ,
primary key(order_id)  );


create table order_details (
order_details_id int not null ,
order_id int not null ,
pizza_id text not null ,
quantity int not null ,
primary key (order_details_id));



select * from order_details;
select count(order_id) as totalorder from orders;
select sum(order_details.quantity*pizzas.price) 
from order_details join pizzas 
on pizzas.pizza_id=order_details.pizza_id ;


select pizza_types.name ,pizzas.price from pizzas join pizza_types 
on pizzas.pizza_type_id=pizza_types.pizza_type_id
order by pizzas.price desc limit 1;


select pizzas.size ,count(order_details.order_details_id)
from pizzas join order_details on pizzas.pizza_id=order_details.pizza_id
group by pizzas.size;


select pizzas.pizza_type_id ,count(order_details.order_details_id)
from pizzas join order_details on pizzas.pizza_id=order_details.pizza_id
group by pizzas.pizza_type_id 
order by order_details.order_details_id desc limit 5;


#intermediate 
select pizza_types.category ,sum(order_details.quantity)
from pizzas 
    join 
    pizza_types 
on pizzas.pizza_type_id=pizza_types.pizza_type_id
    join
    order_details
on pizzas.pizza_id=order_details.pizza_id
 group by pizza_types.category
 order by sum(order_details.quantity)
 
 
 
 select * from orders; 
 select hour(order_time) ,count(order_id)
 from orders
 group by hour(order_time)
 
 
 select category,count(name) from pizza_types 
 group by category 
SELECT 
    DATE(orders.order_date) AS order_day,
    SUM(order_details.quantity) AS total_pizzas
FROM orders
JOIN order_details 
    ON order_details.order_id = orders.order_id
GROUP BY DATE(orders.order_date)
ORDER BY total_pizzas DESC
LIMIT 5;




select avg(aman) from 
(SELECT 
    DATE(orders.order_date) AS order_day,
    sum(order_details.quantity) AS aman
FROM orders
JOIN order_details 
    ON order_details.order_id = orders.order_id
GROUP BY DATE(orders.order_date));




select pizza_types.category,
 sum(order_details.quantity*pizzas.price) as revenue
 from pizza_types join pizzas
       on pizza_types.pizza_type_id=pizzas.pizza_type_id
            join 
            order_details on 
            pizzas.pizza_id=order_details.pizza_id
group by pizza_types.category 
order by revenue



select pizza_types.category ,
sum(order_details.quantity * pizzas.price )/
(select sum(order_details.quantity * pizzas.price)
from pizzas join order_details 
on  pizzas.pizza_id=order_details.pizza_id)
from pizza_types join pizzas on 
 pizza_types.pizza_type_id=pizzas.pizza_type_id
 join order_details on 
 pizzas.pizza_id=order_details.pizza_id
 group by category 
 order by  sum(order_details.quantity * pizzas.price )
 
 
 
select orders.order_date ,
sum(order_details.quantity * pizzas.price )/
(select sum(order_details.quantity * pizzas.price)
from pizzas join order_details 
on  pizzas.pizza_id=order_details.pizza_id)
from pizzas join order_details 
on  pizzas.pizza_id=order_details.pizza_id
 join orders on 
 orders.order_id=order_details.order_id 
 group by orders.order_date
 order by  sum(order_details.quantity * pizzas.price )
 

